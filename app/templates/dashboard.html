{% extends "base.html" %}
{% block content %}

<h3 class="mb-4">Dashboard</h3>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6>Total Pago</h6>
                <h3>R$ {{ "%.2f"|format(total_geral) }}</h3>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6>Quantidade de Cálculos</h6>
                <h3>{{ qtd_calculos }}</h3>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6>Total por Loja</h6>
                <canvas id="graficoLoja"></canvas>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6>Total por Dia (últimos 7 dias)</h6>
                <canvas id="graficoDia"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
const dadosLoja = {
    labels: {{ por_loja | map(attribute=0) | list | tojson }},
    values: {{ por_loja | map(attribute=1) | list | tojson }}
};

const dadosDia = {
    labels: {{ por_dia | map(attribute=0) | list | tojson }},
    values: {{ por_dia | map(attribute=1) | list | tojson }}
};
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/static/dashboard.js"></script>

{% endblock %}
