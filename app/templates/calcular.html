{% extends "base.html" %}
{% block content %}

<h3 class="mb-3">Calcular Rotas</h3>

<form id="formCalculo" enctype="multipart/form-data" class="card card-body shadow-sm mb-4">
    <div class="mb-3">
        <label class="form-label">Loja</label>
        <select name="loja" class="form-select" required>
            {% for key, loja in lojas.items() %}
                <option value="{{ key }}">{{ loja.nome }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">Planilha</label>
        <input type="file" name="planilha" class="form-control" required>
    </div>

    <div class="row">
        <div class="col-md-4">
            <label>Base</label>
            <input type="number" step="0.01" name="base" class="form-control" value="{{ base }}">
        </div>
        <div class="col-md-4">
            <label>Valor KM</label>
            <input type="number" step="0.01" name="km" class="form-control" value="{{ km }}">
        </div>
        <div class="col-md-4">
            <label>MÃ­nimo</label>
            <input type="number" step="0.01" name="minimo" class="form-control" value="{{ minimo }}">
        </div>
    </div>

    <div class="d-grid mt-3">
        <button type="submit" class="btn btn-primary">
            Calcular
        </button>
    </div>
</form>

<!-- MODAL AJUSTES -->
<div class="modal fade" id="modalAjustes" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Ajustes por Motoboy</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <table class="table">
            <thead>
                <tr>
                    <th>Motoboy</th>
                    <th>Total Atual</th>
                    <th>Ajuste (R$)</th>
                    <th>AÃ§Ãµes</th>
                </tr>
            </thead>
            <tbody id="listaAjustes"></tbody>
        </table>
      </div>

      <div class="modal-footer">
        <button id="confirmarAjustes" class="btn btn-success">
            Confirmar Ajustes
        </button>
      </div>

    </div>
  </div>
</div>

<!-- RESULTADO -->
<div class="card shadow-sm">
    <div class="card-body">
        <h5>Resultado Final</h5>

        <table class="table" id="tabelaResultado">
            <thead class="table-dark">
                <tr>
                    <th>Motoboy</th>
                    <th>Entregas</th>
                    <th>KM MÃ©dio</th>
                    <th>Total (R$)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <a id="btnTxt" class="btn btn-success d-none">TXT</a>
        <a id="btnPdf" class="btn btn-secondary d-none ms-2">PDF</a>
    </div>
</div>

<!-- ðŸ”´ ISSO Ã‰ O QUE FALTAVA -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/calcular.js"></script>

{% endblock %}
